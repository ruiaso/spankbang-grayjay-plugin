{
  "name": "SpankBang",
  "description": "SpankBang video platform plugin for Grayjay with pornstar search, recommendations, and improved creator profiles",
  "platformUrl": "https://www.spankbang.com",
  "author": "GreyPluginDev",
  "authorUrl": "https://github.com/GreyPluginDev",
  "sourceUrl": "https://raw.githubusercontent.com/ruiaso/spankbang-grayjay-plugin/refs/heads/main/SpankbangConfig.json",
  "repositoryUrl": "https://github.com/ruiaso/spankbang-grayjay-plugin",
  "scriptUrl": "https://raw.githubusercontent.com/ruiaso/spankbang-grayjay-plugin/refs/heads/main/SpankbangScript.js",
  "version": 49,
  "iconUrl": "https://raw.githubusercontent.com/ruiaso/spankbang-grayjay-plugin/refs/heads/main/icon.png",
  "id": "a1b2c3d4-e5f6-7890-abcd-ef1234567890",
  "packages": [
    "Http",
    "DOMParser",
    "Utilities"
  ],
  "allowAllHttpHeaderAccess": true,
  "allowEval": true,
  "allowUrls": [
    "spankbang.com",
    ".spankbang.com",
    ".spankcdn.com",
    ".sb-cd.com",
    ".sb-cdn.com",
    ".cdn.spankbang.com",
    ".cdn1.spankbang.com",
    ".cdn2.spankbang.com",
    ".cdn3.spankbang.com",
    ".cdn4.spankbang.com",
    "tbi.sb-cd.com"
  ],
  "authentication": {
    "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/131.0.0.0 Safari/537.36",
    "loginUrl": "https://www.spankbang.com/users/login",
    "cookiesToFind": ["sb_session"],
    "cookiesExclOthers": false
  },
  "settings": [
    {
      "variable": "syncRemoteHistory",
      "name": "Sync Remote History",
      "description": "Synchronize account history from SpankBang on startup",
      "type": "Boolean",
      "default": "true"
    }
  ],
  "subscriptionRateLimit": 150,
  "supportedClaimTypes": [
    3
  ],
  "primaryClaimFieldType": 3,
  "changelog": {
    "49": [
      "Enhanced playlist video count extraction with 10+ new patterns",
      "Added support for various HTML structures: <span class='len'>, <p>, <div> elements",
      "Improved regex patterns to match 'X videos', 'X vids', and standalone numbers",
      "Added comprehensive diagnostic logging for playlists with 0 videos",
      "Enhanced parsePlaylistsPage() to log HTML structure for debugging",
      "Better handling of video counts in different contexts (search, import, user playlists)"
    ],
    "48": [
      "Fixed 404 errors on channel contents pagination",
      "Added trailing slashes to all channel/profile URLs for consistency",
      "Improved error handling in getChannelContents() with detailed logging",
      "404 on pagination pages now returns empty results instead of throwing error",
      "Added makeRequestNoThrow usage for better error diagnostics"
    ],
    "47": [
      "Added playlist search functionality - now supports both URL and keyword search",
      "Added regex patterns for external playlist URLs (playlistExternal and playlistSimple)",
      "Updated searchPlaylists() to detect and handle direct playlist URLs",
      "Updated search() to redirect playlist URLs to searchPlaylists()",
      "Updated isPlaylistUrl() to recognize external playlist URLs",
      "Updated getPlaylist() to convert external URLs to internal format",
      "Users can now paste playlist URLs directly in search (e.g., https://spankbang.com/dqcr2/playlist/feet+joi/)",
      "Users can also search playlists by keyword/name"
    ],
    "46": [
      "Fixed playlist import to use cookies directly via http.GET with authenticated client (same as subscriptions)",
      "Fixed history import to use cookies directly without isLoggedIn() check which was failing",
      "Fixed syncRemoteWatchHistory to use cookies directly for better reliability",
      "Enhanced parseHistoryPage with SpankBang-specific <a class='thumb'> pattern for better thumbnail/duration extraction",
      "Added improved fallback patterns for history page parsing",
      "Fixed history thumbnails showing black - now properly extracts from data-src attributes",
      "Fixed history duration showing 0:00 - now extracts from <span class='l'> elements"
    ],
    "45": [
      "Fixed playlist video count parsing to correctly extract from <span class='len'> elements",
      "Added specific regex pattern to match SpankBang's playlist-item anchor tags",
      "Enhanced name extraction to parse <p class='inf'> playlist titles",
      "Improved fallback patterns with wider context search (500 chars) for better video count detection",
      "Fixed slug replacement to handle '+' characters in playlist URLs"
    ],
    "44": [
      "Fixed playlist video parsing with enhanced multi-tier fallback patterns",
      "Added comprehensive logging to diagnose empty playlist issues",
      "Improved parseSearchResults with 4 different extraction strategies",
      "Enhanced authentication handling for playlist page requests",
      "Added duplicate video detection to prevent repeated entries"
    ],
    "43": [
      "Fixed playlist video count parsing with enhanced regex patterns",
      "Improved playlist import functionality with better error handling",
      "Added comprehensive logging for playlist operations",
      "Enhanced video count extraction from multiple HTML patterns"
    ],
    "41": [
      "Fixed authentication flow - updated completionUrl and added more cookies to find",
      "Improved hasValidAuthCookie to accept multiple auth cookie types",
      "Updated User-Agent in auth config to match modern Chrome browser"
    ],
    "40": [
      "Added USER_URLS constants for playlists, history, subscriptions",
      "Improved history page parsing for better thumbnail and duration extraction",
      "Fixed video thumbnails and duration showing 0:00 in history sync"
    ],
    "38": [
      "Fixed settings default value format (boolean to string)"
    ]
  }
}